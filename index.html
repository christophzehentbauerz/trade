<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTC Market Intelligence Dashboard</title>
    <meta name="description"
        content="Echtzeit Bitcoin Marktanalyse mit technischen Indikatoren, On-Chain Daten und Trading-Signalen">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="analysis-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Signal Alert Popup (slides in from top when new signal) -->
    <div id="signalAlert" class="signal-alert">
        <!-- Content filled by JS -->
    </div>

    <div class="app">
        <!-- Notification Settings Bar -->
        <section class="notification-settings">
            <div class="notification-settings-content">
                <div class="notification-info">
                    <span class="notification-icon">üîî</span>
                    <div class="notification-text">
                        <strong>Benachrichtigungen</strong>
                        <span id="notificationStatus" class="notification-status inactive">
                            ‚ö†Ô∏è Aktiviere Benachrichtigungen um informiert zu werden
                        </span>
                    </div>
                </div>
                <div class="notification-buttons">
                    <button id="toggleNotifications" class="notif-btn">üîï Benachrichtigungen AUS</button>
                    <button id="toggleSound" class="notif-btn active">üîä Sound AN</button>
                    <button id="testNotification" class="notif-btn test-btn" title="Test-Alarm abspielen">üîî
                        Testen</button>
                    <button id="testTelegram" class="notif-btn test-btn telegram-btn"
                        title="Telegram Test-Nachricht senden">üì±
                        Telegram Test</button>
                </div>
            </div>
        </section>

        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <span class="logo-icon">‚Çø</span>
                    <span class="logo-text">Market Intelligence</span>
                </div>
            </div>
            <div class="header-right">
                <div class="last-update" title="Zeitpunkt der letzten Datenaktualisierung">
                    <span class="update-label">Letztes Update:</span>
                    <span id="lastUpdate" class="update-time">--:--:--</span>
                </div>
                <button id="refreshBtn" class="refresh-btn"
                    title="Klicke hier oder dr√ºcke 'R' um die Daten manuell zu aktualisieren">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15" />
                    </svg>
                </button>
                <button id="tradeAnalysisBtn" class="trade-analysis-btn"
                    title="Klicke f√ºr Live Trading-Empfehlung mit Entry/SL/TP">
                    üìä TRADE-ANALYSE
                </button>
                <div class="auto-refresh" title="Countdown bis zur n√§chsten automatischen Aktualisierung">
                    <span class="countdown" id="countdown">5:00</span>
                </div>
            </div>
        </header>

        <!-- How it Works Section (Collapsible) -->
        <section class="how-it-works-section">
            <details class="how-it-works">
                <summary class="how-it-works-toggle">
                    üìö Wie funktioniert dieses Dashboard? (Klick zum √ñffnen)
                </summary>
                <div class="how-it-works-content">

                    <!-- What is this dashboard -->
                    <div class="info-section">
                        <h3>üéØ Was ist dieses Dashboard?</h3>
                        <p>
                            Dieses Dashboard sammelt automatisch Marktdaten aus verschiedenen Quellen und berechnet
                            daraus ein <strong>Trading-Signal</strong> (LONG, SHORT oder NEUTRAL). Das Signal sagt dir,
                            ob der Markt gerade g√ºnstig f√ºr einen Kauf (LONG), Verkauf (SHORT) oder zum Abwarten
                            (NEUTRAL) ist.
                        </p>
                    </div>

                    <!-- When is a trade recommended -->
                    <div class="info-section highlight-section">
                        <h3>‚úÖ Wann wird ein Trade empfohlen?</h3>
                        <p>Ein Trade wird <strong>NUR</strong> empfohlen, wenn der <strong>Gesamtscore</strong>
                            eindeutig ist:</p>
                        <div class="rules-grid">
                            <div class="rule-box rule-long">
                                <div class="rule-title">üü¢ LONG (Kaufen)</div>
                                <div class="rule-condition">Score ‚â• 6.5 / 10</div>
                                <div class="rule-desc">Mehrere Indikatoren zeigen bullische Signale</div>
                            </div>
                            <div class="rule-box rule-short">
                                <div class="rule-title">üî¥ SHORT (Verkaufen)</div>
                                <div class="rule-condition">Score ‚â§ 3.5 / 10</div>
                                <div class="rule-desc">Mehrere Indikatoren zeigen bearische Signale</div>
                            </div>
                            <div class="rule-box rule-neutral">
                                <div class="rule-title">‚ö™ NEUTRAL (Abwarten)</div>
                                <div class="rule-condition">Score zwischen 3.5 und 6.5</div>
                                <div class="rule-desc">Signale sind gemischt ‚Üí Kein Trade!</div>
                            </div>
                        </div>
                    </div>

                    <!-- What factors count -->
                    <div class="info-section">
                        <h3>üìä Welche Faktoren flie√üen ein?</h3>
                        <p>Der Gesamtscore wird aus <strong>4 Kategorien</strong> berechnet:</p>
                        <table class="factors-table">
                            <tr>
                                <th>Kategorie</th>
                                <th>Gewichtung</th>
                                <th>Was wird analysiert?</th>
                            </tr>
                            <tr>
                                <td><strong>Technische Analyse</strong></td>
                                <td>35%</td>
                                <td>RSI, Trend-Richtung, EMA-Position, Volatilit√§t</td>
                            </tr>
                            <tr>
                                <td><strong>On-Chain Daten</strong></td>
                                <td>25%</td>
                                <td>Preis-Momentum, Handelsvolumen</td>
                            </tr>
                            <tr>
                                <td><strong>Sentiment</strong></td>
                                <td>20%</td>
                                <td>Fear & Greed Index, Funding Rate, Long/Short Ratio</td>
                            </tr>
                            <tr>
                                <td><strong>Makro</strong></td>
                                <td>20%</td>
                                <td>Abstand zum ATH, Markttrends</td>
                            </tr>
                        </table>
                    </div>

                    <!-- Glossary -->
                    <div class="info-section">
                        <h3>üìñ Erkl√§rung der Begriffe</h3>

                        <div class="glossary-grid">
                            <div class="glossary-item">
                                <div class="glossary-term">üìà Derivatives (Derivate)</div>
                                <div class="glossary-def">
                                    <strong>Was ist das?</strong> Finanzprodukte, die auf dem Bitcoin-Preis basieren,
                                    aber nicht echter Bitcoin sind. Dazu geh√∂ren <em>Futures</em> (Wetten auf zuk√ºnftige
                                    Preise)
                                    und <em>Optionen</em>.<br><br>
                                    <strong>Warum wichtig?</strong> Hier handeln professionelle Trader mit Hebel.
                                    Die Daten zeigen, wie diese "Smart Money"-Trader positioniert sind.
                                    Wenn z.B. viele Short-Positionen offen sind, kann das ein Zeichen sein,
                                    dass der Preis bald steigt (weil diese Shorts "gequetscht" werden k√∂nnen).
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üí∞ Funding Rate</div>
                                <div class="glossary-def">
                                    Eine Geb√ºhr, die alle 8 Stunden zwischen Long- und Short-Tradern ausgetauscht
                                    wird.<br><br>
                                    ‚Ä¢ <strong>Positiv:</strong> Longs zahlen an Shorts ‚Üí Zu viele sind long ‚Üí
                                    Bearish<br>
                                    ‚Ä¢ <strong>Negativ:</strong> Shorts zahlen an Longs ‚Üí Zu viele sind short ‚Üí
                                    Bullish<br><br>
                                    <em>Wird als Kontraindikator verwendet!</em>
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üìä Open Interest (OI)</div>
                                <div class="glossary-def">
                                    Die Gesamtsumme aller offenen Futures-Positionen in Dollar.<br><br>
                                    ‚Ä¢ <strong>Steigend + Preis steigt:</strong> Starker Aufw√§rtstrend<br>
                                    ‚Ä¢ <strong>Steigend + Preis f√§llt:</strong> Starker Abw√§rtstrend<br>
                                    ‚Ä¢ <strong>Fallend:</strong> Trader schlie√üen Positionen, weniger Interesse
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">‚öñÔ∏è Long/Short Ratio</div>
                                <div class="glossary-def">
                                    Zeigt das Verh√§ltnis zwischen Long- und Short-Positionen.<br><br>
                                    ‚Ä¢ <strong>Mehr Longs (>55%):</strong> Die Masse ist bullish ‚Üí Potenzielle
                                    Korrektur<br>
                                    ‚Ä¢ <strong>Mehr Shorts (>55%):</strong> Die Masse ist bearish ‚Üí Potentieller
                                    Anstieg<br><br>
                                    <em>Wird als Kontraindikator verwendet!</em>
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üò± Fear & Greed Index</div>
                                <div class="glossary-def">
                                    Misst die Emotionen im Markt von 0 (extreme Angst) bis 100 (extreme Gier).<br><br>
                                    ‚Ä¢ <strong>0-25 (Angst):</strong> "Be greedy when others are fearful" ‚Üí
                                    Kaufsignal<br>
                                    ‚Ä¢ <strong>75-100 (Gier):</strong> "Be fearful when others are greedy" ‚Üí
                                    Verkaufssignal<br><br>
                                    <em>Klassischer Kontraindikator nach Warren Buffett!</em>
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üìâ RSI (Relative Strength Index)</div>
                                <div class="glossary-def">
                                    Ein Momentum-Indikator von 0-100, der zeigt ob ein Asset √ºberkauft oder √ºberverkauft
                                    ist.<br><br>
                                    ‚Ä¢ <strong>Unter 30:</strong> √úberverkauft ‚Üí Potenzielle Kaufgelegenheit<br>
                                    ‚Ä¢ <strong>√úber 70:</strong> √úberkauft ‚Üí Potenzielle Verkaufsgelegenheit<br>
                                    ‚Ä¢ <strong>30-70:</strong> Neutraler Bereich
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üìà EMA (Exponential Moving Average)</div>
                                <div class="glossary-def">
                                    Ein gleitender Durchschnitt, der neueren Preisen mehr Gewicht gibt.<br><br>
                                    ‚Ä¢ <strong>Preis √ºber EMA:</strong> Aufw√§rtstrend, bullish<br>
                                    ‚Ä¢ <strong>Preis unter EMA:</strong> Abw√§rtstrend, bearish<br><br>
                                    Die 200-Tage-EMA ist besonders wichtig als langfristiger Trendindikator.
                                </div>
                            </div>

                            <div class="glossary-item">
                                <div class="glossary-term">üéØ Liquidation Zones</div>
                                <div class="glossary-def">
                                    Preisniveaus, bei denen viele gehebelte Positionen zwangsliquidiert werden.<br><br>
                                    Der Preis tendiert oft dazu, diese Zonen "abzuholen", weil Market Maker dort
                                    Liquidit√§t finden.
                                    <br><br>
                                    ‚Ä¢ <strong>Long Liquidations:</strong> Unter dem aktuellen Preis<br>
                                    ‚Ä¢ <strong>Short Liquidations:</strong> √úber dem aktuellen Preis
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Important notes -->
                    <div class="info-section warning-section">
                        <h3>‚ö†Ô∏è Wichtige Hinweise</h3>
                        <ul>
                            <li><strong>Kontraindikator:</strong> Wenn "alle" in eine Richtung positioniert sind,
                                passiert oft das Gegenteil. Deshalb werden Fear & Greed und L/S Ratio umgekehrt
                                interpretiert.</li>
                            <li><strong>Konfidenz max. 85%:</strong> M√§rkte sind nie 100% vorhersagbar.
                                Selbst bei starken Signalen bleibt Unsicherheit.</li>
                            <li><strong>Keine Finanzberatung:</strong> Dies ist ein Analyse-Tool, keine Empfehlung.
                                Investiere nur was du verlieren kannst.</li>
                        </ul>
                    </div>
                </div>
            </details>
        </section>

        <!-- Main Signal Banner -->
        <section class="signal-banner" id="signalBanner">
            <div class="signal-content">
                <div class="signal-primary">
                    <span class="signal-label">PRIM√ÑRES SIGNAL</span>
                    <span class="signal-value" id="primarySignal">LOADING...</span>
                </div>
                <div class="signal-confidence"
                    title="Je h√∂her die Konfidenz, desto sicherer ist das Signal. Max. 85% weil M√§rkte nie 100% vorhersagbar sind.">
                    <span class="confidence-label">Konfidenz</span>
                    <div class="confidence-bar">
                        <div class="confidence-fill" id="confidenceFill" style="width: 0%"></div>
                    </div>
                    <span class="confidence-value" id="confidenceValue">--%</span>
                </div>
                <div class="signal-summary" id="signalSummary">
                    Lade Marktdaten...
                </div>
            </div>
            <!-- Signal Explanation Box -->
            <div class="signal-explanation" id="signalExplanation">
                <div class="explanation-title">‚ÑπÔ∏è Was bedeutet das Signal?</div>
                <div class="explanation-content" id="signalExplanationContent">
                    Warte auf Daten...
                </div>
            </div>
        </section>

        <!-- No Trade Warning Box (shown when neutral) -->
        <section class="no-trade-warning" id="noTradeWarning" style="display: none;">
            <div class="warning-icon">‚ö†Ô∏è</div>
            <div class="warning-content">
                <h3>Kein Trade empfohlen - Warum?</h3>
                <div id="noTradeReasons">
                    <!-- Filled by JS -->
                </div>
            </div>
        </section>

        <!-- Main Grid -->
        <main class="dashboard-grid">
            <!-- Price Card -->
            <section class="card price-card">
                <div class="card-header">
                    <h2><span class="card-icon">üí∞</span> Bitcoin Preis</h2>
                    <span class="info-badge"
                        title="Aktueller Bitcoin-Preis in US-Dollar. Daten von CoinGecko API.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        Der aktuelle Bitcoin-Kurs zeigt dir den Marktwert. Die 24h-√Ñnderung zeigt,
                        ob BTC heute gestiegen (gr√ºn) oder gefallen (rot) ist.
                    </div>
                    <div class="price-main">
                        <span class="price-currency">$</span>
                        <span class="price-value" id="btcPrice">--,---</span>
                    </div>
                    <div class="price-change" id="priceChange">
                        <span class="change-value">--%</span>
                        <span class="change-period">24h</span>
                    </div>
                    <div class="price-meta">
                        <div class="meta-item" title="Gesamtwert aller existierenden Bitcoins zusammen">
                            <span class="meta-label">Market Cap</span>
                            <span class="meta-value" id="marketCap">$--</span>
                        </div>
                        <div class="meta-item"
                            title="Wie viel Handelsvolumen in den letzten 24 Stunden - zeigt die Aktivit√§t im Markt">
                            <span class="meta-label">24h Volume</span>
                            <span class="meta-value" id="volume24h">$--</span>
                        </div>
                        <div class="meta-item"
                            title="All-Time High: Der h√∂chste Preis, den Bitcoin jemals erreicht hat">
                            <span class="meta-label">ATH</span>
                            <span class="meta-value" id="ath">$--</span>
                        </div>
                        <div class="meta-item"
                            title="Prozentuale Entfernung vom Allzeithoch - zeigt wie weit wir vom Top entfernt sind">
                            <span class="meta-label">Von ATH</span>
                            <span class="meta-value" id="athChange">--%</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Fear & Greed Card -->
            <section class="card fear-greed-card">
                <div class="card-header">
                    <h2><span class="card-icon">üò±</span> Fear & Greed Index</h2>
                    <span class="info-badge"
                        title="Misst die Stimmung am Markt von 0 (extreme Angst) bis 100 (extreme Gier). Extreme Werte sind oft KONTRAINDIKATOREN!">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        <strong>Was ist das?</strong> Dieser Index misst die Emotionen im Markt.<br>
                        <strong>Wichtig:</strong> Er wird als <em>Kontraindikator</em> verwendet!<br>
                        ‚Ä¢ <span class="text-bearish">0-25 = Extreme Angst</span> ‚Üí Oft guter Kaufzeitpunkt<br>
                        ‚Ä¢ <span class="text-bullish">75-100 = Extreme Gier</span> ‚Üí Oft guter Verkaufszeitpunkt
                    </div>
                    <div class="gauge-container">
                        <div class="gauge">
                            <div class="gauge-fill" id="gaugeFill"></div>
                            <div class="gauge-center">
                                <span class="gauge-value" id="fearGreedValue">--</span>
                                <span class="gauge-label" id="fearGreedLabel">Loading</span>
                            </div>
                        </div>
                        <div class="gauge-scale">
                            <span>0</span>
                            <span>25</span>
                            <span>50</span>
                            <span>75</span>
                            <span>100</span>
                        </div>
                    </div>
                    <div class="fear-greed-history" id="fearGreedHistory">
                        <!-- History items populated by JS -->
                    </div>
                    <div class="fear-greed-interpretation" id="fearGreedInterpretation">
                        --
                    </div>
                </div>
            </section>

            <!-- Technical Analysis Card -->
            <section class="card technical-card">
                <div class="card-header">
                    <h2><span class="card-icon">üìä</span> Technische Analyse</h2>
                    <span class="card-badge" id="technicalBadge">--/10</span>
                    <span class="info-badge"
                        title="Analyse basierend auf Preischarts und mathematischen Indikatoren. Gewichtung: 35% des Gesamtsignals.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        Technische Indikatoren analysieren vergangene Preisbewegungen,
                        um zuk√ºnftige Trends vorherzusagen.
                    </div>
                    <div class="indicator-grid">
                        <div class="indicator" id="rsiIndicator">
                            <div class="indicator-header">
                                <span class="indicator-name"
                                    title="Relative Strength Index: Misst ob BTC √ºberkauft (>70) oder √ºberverkauft (<30) ist">RSI
                                    (14)</span>
                                <span class="indicator-value" id="rsiValue">--</span>
                            </div>
                            <div class="indicator-explanation">
                                RSI unter 30 = √úberverkauft (Kaufsignal)<br>
                                RSI √ºber 70 = √úberkauft (Verkaufssignal)
                            </div>
                            <div class="indicator-bar">
                                <div class="indicator-zones">
                                    <div class="zone oversold"></div>
                                    <div class="zone neutral"></div>
                                    <div class="zone overbought"></div>
                                </div>
                                <div class="indicator-marker" id="rsiMarker"></div>
                            </div>
                            <div class="indicator-labels">
                                <span>√úberverkauft</span>
                                <span>Neutral</span>
                                <span>√úberkauft</span>
                            </div>
                        </div>

                        <div class="indicator" id="trendIndicator">
                            <div class="indicator-header">
                                <span class="indicator-name"
                                    title="Zeigt die aktuelle Preisrichtung basierend auf den letzten 14 Tagen">Trend</span>
                                <span class="indicator-value" id="trendValue">--</span>
                            </div>
                            <div class="indicator-explanation">
                                Bullish = Preis steigt<br>
                                Bearish = Preis f√§llt
                            </div>
                            <div class="trend-visual" id="trendVisual">
                                <div class="trend-arrow"></div>
                            </div>
                        </div>

                        <div class="indicator" id="emaIndicator">
                            <div class="indicator-header">
                                <span class="indicator-name"
                                    title="Exponential Moving Average: Durchschnittspreis der letzten 200 Tage. Preis dar√ºber = bullish, darunter = bearish">vs
                                    EMA</span>
                                <span class="indicator-value" id="emaValue">--</span>
                            </div>
                            <div class="indicator-explanation">
                                Preis √ºber EMA = Bullish<br>
                                Preis unter EMA = Bearish
                            </div>
                            <div class="ema-status" id="emaStatus">
                                <span class="ema-label">Preis ist</span>
                                <span class="ema-position" id="emaPosition">--</span>
                            </div>
                        </div>

                        <div class="indicator" id="volatilityIndicator">
                            <div class="indicator-header">
                                <span class="indicator-name"
                                    title="Wie stark der Preis schwankt. Hohe Volatilit√§t = mehr Risiko, aber auch mehr Chancen">Volatilit√§t</span>
                                <span class="indicator-value" id="volatilityValue">--</span>
                            </div>
                            <div class="indicator-explanation">
                                Niedrig = Ruhiger Markt<br>
                                Hoch = Starke Schwankungen
                            </div>
                            <div class="volatility-meter">
                                <div class="volatility-bar" id="volatilityBar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Derivatives Card -->
            <section class="card derivatives-card">
                <div class="card-header">
                    <h2><span class="card-icon">üìà</span> Derivatives</h2>
                    <span class="card-badge" id="derivativesBadge">--/10</span>
                    <span class="info-badge"
                        title="Daten aus dem Futures-Markt. Zeigt wie Trader mit Hebel positioniert sind.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        Derivatives zeigen, wie professionelle Trader mit Hebel wetten.
                        Diese Daten sind oft ein Fr√ºhindikator f√ºr Preisbewegungen.
                    </div>
                    <div class="derivatives-grid">
                        <div class="derivative-item">
                            <span class="derivative-label"
                                title="Geb√ºhr die Long-Trader an Short-Trader zahlen (oder umgekehrt). Negativ = Shorts zahlen = bullish">Funding
                                Rate</span>
                            <span class="derivative-value" id="fundingRate">--%</span>
                            <span class="derivative-status" id="fundingStatus">--</span>
                            <div class="item-explanation">
                                Negativ = Shorts zahlen ‚Üí Bullish<br>
                                Stark positiv = Longs zahlen ‚Üí Bearish
                            </div>
                        </div>
                        <div class="derivative-item">
                            <span class="derivative-label"
                                title="Gesamtwert aller offenen Futures-Positionen. Hoher OI + Preisanstieg = Starker Trend">Open
                                Interest</span>
                            <span class="derivative-value" id="openInterest">$--</span>
                            <span class="derivative-status" id="oiChange">--</span>
                            <div class="item-explanation">
                                Zeigt wie viel Geld in Futures steckt.<br>
                                Steigend = Mehr Interesse am Markt
                            </div>
                        </div>
                        <div class="derivative-item">
                            <span class="derivative-label"
                                title="Verh√§ltnis zwischen Long- und Short-Positionen. Extremwerte sind oft Kontraindikatoren">Long/Short
                                Ratio</span>
                            <div class="ls-ratio-bar">
                                <div class="ls-long" id="lsLong" style="width: 50%"></div>
                                <div class="ls-short" id="lsShort" style="width: 50%"></div>
                            </div>
                            <div class="ls-labels">
                                <span id="longPercent">50%</span>
                                <span id="shortPercent">50%</span>
                            </div>
                            <div class="item-explanation">
                                Mehr Shorts = Kontr√§r bullish<br>
                                Mehr Longs = Kontr√§r bearish
                            </div>
                        </div>
                        <div class="derivative-item liquidations">
                            <span class="derivative-label"
                                title="Preisniveaus wo viele Positionen liquidiert werden. Der Preis wird oft dorthin gezogen">Liquidation
                                Zones</span>
                            <div class="liq-zones">
                                <div class="liq-zone liq-longs">
                                    <span class="liq-label">Longs</span>
                                    <span class="liq-price" id="liqLongs">$--</span>
                                </div>
                                <div class="liq-zone liq-shorts">
                                    <span class="liq-label">Shorts</span>
                                    <span class="liq-price" id="liqShorts">$--</span>
                                </div>
                            </div>
                            <div class="item-explanation">
                                Preis tendiert dazu, Liquidationen abzuholen.
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sentiment Card -->
            <section class="card sentiment-card">
                <div class="card-header">
                    <h2><span class="card-icon">üé≠</span> Sentiment & Positioning</h2>
                    <span class="card-badge" id="sentimentBadge">--/10</span>
                    <span class="info-badge"
                        title="Zusammenfassung der Marktstimmung. Gewichtung: 20% des Gesamtsignals.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        Sentiment zeigt die aktuelle Marktstimmung. <strong>Wichtig:</strong>
                        Extreme Werte werden als Kontraindikator genutzt (wenn alle bullish sind, ist oft der Top
                        erreicht).
                    </div>
                    <div class="sentiment-summary">
                        <div class="sentiment-meter">
                            <div class="meter-labels">
                                <span>Bearish</span>
                                <span>Neutral</span>
                                <span>Bullish</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill" id="sentimentFill"></div>
                                <div class="meter-marker" id="sentimentMarker"></div>
                            </div>
                        </div>
                        <div class="sentiment-factors">
                            <div class="factor" title="Fear & Greed als Kontraindikator">
                                <span class="factor-icon" id="fgIcon">üò±</span>
                                <span class="factor-name">Fear & Greed</span>
                                <span class="factor-signal" id="fgSignal">--</span>
                            </div>
                            <div class="factor" title="Funding Rate Interpretation">
                                <span class="factor-icon">üí∞</span>
                                <span class="factor-name">Funding</span>
                                <span class="factor-signal" id="fundingSignal">--</span>
                            </div>
                            <div class="factor" title="Long/Short Ratio als Kontraindikator">
                                <span class="factor-icon">üìä</span>
                                <span class="factor-name">L/S Ratio</span>
                                <span class="factor-signal" id="lsSignal">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Trade Setup Card -->
            <section class="card trade-card">
                <div class="card-header">
                    <h2><span class="card-icon">üéØ</span> Trade Setup</h2>
                    <span class="info-badge"
                        title="Konkrete Handelsempfehlung basierend auf der Analyse. NUR wenn ein Signal vorhanden ist!">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        <strong>Entry Zone:</strong> Empfohlener Einstiegspreis<br>
                        <strong>Stop Loss:</strong> Preis wo du aussteigen solltest wenn es falsch l√§uft<br>
                        <strong>Take Profit:</strong> Preise wo du Gewinne mitnehmen solltest<br>
                        <strong>R:R:</strong> Risk-Reward-Verh√§ltnis (1:2 = doppelter Gewinn im Vergleich zum Risiko)
                    </div>
                    <div class="trade-direction" id="tradeDirection">
                        <span class="direction-label">Richtung</span>
                        <span class="direction-value">--</span>
                    </div>
                    <div class="trade-levels">
                        <div class="level entry" title="Der Preisbereich in dem du einsteigen solltest">
                            <span class="level-label">Entry Zone</span>
                            <span class="level-value" id="entryZone">$-- - $--</span>
                        </div>
                        <div class="level stoploss"
                            title="WICHTIG: Hier aussteigen wenn der Trade gegen dich l√§uft. Begrenzt deinen Verlust!">
                            <span class="level-label">Stop Loss</span>
                            <span class="level-value" id="stopLoss">$--</span>
                            <span class="level-percent" id="slPercent">(--%)</span>
                        </div>
                        <div class="level takeprofit" title="Erstes Gewinnziel - hier 50% der Position schlie√üen">
                            <span class="level-label">Take Profit 1</span>
                            <span class="level-value" id="tp1">$--</span>
                            <span class="level-rr" id="tp1rr">R:R --</span>
                        </div>
                        <div class="level takeprofit"
                            title="Zweites Gewinnziel - hier weitere 30% der Position schlie√üen">
                            <span class="level-label">Take Profit 2</span>
                            <span class="level-value" id="tp2">$--</span>
                            <span class="level-rr" id="tp2rr">R:R --</span>
                        </div>
                        <div class="level takeprofit" title="Drittes Gewinnziel - hier die restlichen 20% schlie√üen">
                            <span class="level-label">Take Profit 3</span>
                            <span class="level-value" id="tp3">$--</span>
                            <span class="level-rr" id="tp3rr">R:R --</span>
                        </div>
                    </div>
                    <div class="trade-recommendations">
                        <div class="rec-item" title="Wie viel Prozent deines Kapitals du maximal riskieren solltest">
                            <span class="rec-label">Position Size</span>
                            <span class="rec-value" id="positionSize">--%</span>
                        </div>
                        <div class="rec-item" title="Maximaler empfohlener Hebel. H√ñHERER HEBEL = H√ñHERES RISIKO!">
                            <span class="rec-label">Max Hebel</span>
                            <span class="rec-value" id="maxLeverage">--x</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Key Levels Card -->
            <section class="card levels-card">
                <div class="card-header">
                    <h2><span class="card-icon">üìç</span> Key Levels</h2>
                    <span class="info-badge"
                        title="Wichtige Preisniveaus. Widerst√§nde stoppen Aufw√§rtsbewegungen, Unterst√ºtzungen stoppen Abw√§rtsbewegungen.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        <strong>Widerst√§nde (rot):</strong> Preisniveaus wo Verkaufsdruck erwartet wird<br>
                        <strong>Unterst√ºtzungen (gr√ºn):</strong> Preisniveaus wo Kaufinteresse erwartet wird
                    </div>
                    <div class="levels-container">
                        <div class="levels-section resistances">
                            <h3>üî¥ Widerst√§nde</h3>
                            <ul id="resistancesList">
                                <li><span class="level-price">$--</span><span class="level-desc">--</span></li>
                            </ul>
                        </div>
                        <div class="levels-section supports">
                            <h3>üü¢ Unterst√ºtzungen</h3>
                            <ul id="supportsList">
                                <li><span class="level-price">$--</span><span class="level-desc">--</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Risk Factors Card -->
            <section class="card risk-card">
                <div class="card-header">
                    <h2><span class="card-icon">‚ö†Ô∏è</span> Risiko-Faktoren</h2>
                    <span class="info-badge"
                        title="Wichtige Warnsignale und Events die deine Position beeinflussen k√∂nnten.">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        <strong>Invalidation:</strong> Wenn diese Bedingungen eintreten, ist das Trade-Setup
                        hinf√§llig!<br>
                        <strong>Events:</strong> Termine die zu starker Volatilit√§t f√ºhren k√∂nnen.
                    </div>
                    <div class="risk-section">
                        <h3>üö´ Trade Invalidation</h3>
                        <ul id="invalidationList">
                            <li>--</li>
                        </ul>
                    </div>
                    <div class="risk-section">
                        <h3>üìÖ Upcoming Events</h3>
                        <ul id="eventsList">
                            <li>--</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Backtest Results Card -->
            <section class="card backtest-card">
                <div class="card-header">
                    <h2><span class="card-icon">üî¨</span> Backtest Ergebnisse</h2>
                    <button id="runBacktestBtn" class="backtest-run-btn"
                        title="Testet die Strategie gegen historische Daten">
                        üî¨ Backtest Starten
                    </button>
                    <span class="info-badge"
                        title="Testet wie gut die Strategie in der Vergangenheit funktioniert h√§tte">?</span>
                </div>
                <div class="card-body">
                    <div id="backtestLoading" class="backtest-loading" style="display: none;">
                        <div class="loading-spinner"></div>
                        <p>Analysiere historische Daten...</p>
                    </div>

                    <div id="backtestResults" class="backtest-results" style="display: none;">
                        <div class="backtest-summary">
                            <div class="summary-item win-rate-item">
                                <div class="summary-label">Win Rate</div>
                                <div class="summary-value" id="backtestWinRate">--</div>
                                <div class="summary-badge" id="backtestRating">--</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Trades Gesamt</div>
                                <div class="summary-value" id="backtestTotalTrades">--</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">√ò Gewinn</div>
                                <div class="summary-value text-bullish" id="backtestAvgWin">--</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">√ò Verlust</div>
                                <div class="summary-value text-bearish" id="backtestAvgLoss">--</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Gesamt Return</div>
                                <div class="summary-value" id="backtestTotalReturn">--</div>
                            </div>
                        </div>

                        <div class="backtest-breakdown">
                            <div class="breakdown-section">
                                <h3>‚úÖ Gewinn-Trades (<span id="backtestWins">--</span>)</h3>
                                <div class="breakdown-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Bester Trade:</span>
                                        <span class="stat-value text-bullish" id="backtestBestTrade">--</span>
                                    </div>
                                </div>
                            </div>
                            <div class="breakdown-section">
                                <h3>‚ùå Verlust-Trades (<span id="backtestLosses">--</span>)</h3>
                                <div class="breakdown-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Schlechtester Trade:</span>
                                        <span class="stat-value text-bearish" id="backtestWorstTrade">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="backtest-failures">
                            <h3>üîç Fehleranalyse</h3>
                            <div class="failure-stats">
                                <div class="failure-item">
                                    <span class="failure-icon">üõë</span>
                                    <span class="failure-label">Stop Loss getroffen</span>
                                    <span class="failure-count" id="failureStopLoss">--</span>
                                </div>
                                <div class="failure-item">
                                    <span class="failure-icon">‚è±Ô∏è</span>
                                    <span class="failure-label">Timeout (14 Tage)</span>
                                    <span class="failure-count" id="failureTimeout">--</span>
                                </div>
                            </div>
                        </div>

                        <details class="backtest-details">
                            <summary>üìã Alle Trades anzeigen</summary>
                            <div id="backtestTradeList" class="trade-list">
                                <!-- Filled by JS -->
                            </div>
                        </details>
                    </div>

                    <div id="backtestEmpty" class="backtest-empty">
                        <p>üî¨ Klicke auf "Backtest Starten" um die Strategie gegen historische Daten zu testen.</p>
                        <p class="backtest-info">
                            <strong>Was wird getestet?</strong><br>
                            Die letzten 60 Trade-Signale aus den vergangenen 12 Monaten werden simuliert und mit echten
                            historischen Preisdaten verglichen.
                            Du siehst dann wie oft die Strategie erfolgreich war und warum Trades fehlgeschlagen sind.
                        </p>
                    </div>
                </div>
            </section>

            <!-- Score Breakdown Card -->
            <section class="card score-card">
                <div class="card-header">
                    <h2><span class="card-icon">üìã</span> Score Breakdown</h2>
                    <span class="info-badge"
                        title="So wird das Signal berechnet: Technisch 35%, On-Chain 25%, Sentiment 20%, Makro 20%">?</span>
                </div>
                <div class="card-body">
                    <div class="explanation-box">
                        <strong>Score-Regeln:</strong><br>
                        ‚Ä¢ Score ‚â• 6.5 ‚Üí LONG Signal (Kaufen)<br>
                        ‚Ä¢ Score ‚â§ 3.5 ‚Üí SHORT Signal (Verkaufen)<br>
                        ‚Ä¢ Score 3.5 - 6.5 ‚Üí NEUTRAL (Kein Trade!)
                    </div>
                    <div class="score-items">
                        <div class="score-item" title="Gewichtung: 35% - RSI, Trend, EMA-Position">
                            <span class="score-name">Technische Analyse</span>
                            <div class="score-bar">
                                <div class="score-fill" id="techScoreFill"></div>
                            </div>
                            <span class="score-value" id="techScore">--/10</span>
                        </div>
                        <div class="score-item" title="Gewichtung: 25% - Whale-Aktivit√§t, Exchange-Flows">
                            <span class="score-name">On-Chain Daten</span>
                            <div class="score-bar">
                                <div class="score-fill" id="onchainScoreFill"></div>
                            </div>
                            <span class="score-value" id="onchainScore">--/10</span>
                        </div>
                        <div class="score-item" title="Gewichtung: 20% - Fear & Greed, Funding, L/S Ratio">
                            <span class="score-name">Sentiment</span>
                            <div class="score-bar">
                                <div class="score-fill" id="sentimentScoreFill"></div>
                            </div>
                            <span class="score-value" id="sentimentScore">--/10</span>
                        </div>
                        <div class="score-item" title="Gewichtung: 20% - ATH-Distanz, Makro-Trends">
                            <span class="score-name">Makro</span>
                            <div class="score-bar">
                                <div class="score-fill" id="macroScoreFill"></div>
                            </div>
                            <span class="score-value" id="macroScore">--/10</span>
                        </div>
                    </div>
                    <div class="total-score">
                        <span class="total-label">Gewichteter Gesamtscore</span>
                        <span class="total-value" id="totalScore">--/10</span>
                    </div>
                    <div class="score-interpretation" id="scoreInterpretation">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </section>

            <!-- Live Trade Analysis Card -->
            <section class="analysis-card-container" id="analysisCardContainer" style="display: none;">
                <div class="card analysis-card">
                    <div class="card-header">
                        <h2>üéØ Live Trading-Analyse</h2>
                        <button class="close-analysis-btn" id="closeAnalysisBtn">‚úï</button>
                    </div>
                    <div class="card-body">
                        <div class="analysis-content" id="analysisContent">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Disclaimer Footer -->
        <footer class="disclaimer">
            <p>‚ö†Ô∏è <strong>Disclaimer:</strong> Dies ist KEINE Finanzberatung. Kryptow√§hrungen sind hochvolatil.
                Investiere nur, was du verlieren kannst. Die Konfidenz-Werte sind Sch√§tzungen basierend auf
                historischen Mustern, keine Garantien.</p>
        </footer>
    </div>

    <script src="backtester.js"></script>
    <script src="live-analysis.js"></script>
    <script src="app.js"></script>

    <!-- Custom Tooltip Logic -->
    <style>
        /* Custom Tooltip Styling */
        .info-badge {
            cursor: pointer;
            position: relative;
        }

        .tooltip-popup {
            display: none;
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.95);
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.85rem;
            width: max-content;
            max-width: 250px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            line-height: 1.4;
            pointer-events: none;
        }

        .tooltip-popup::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(15, 23, 42, 0.95) transparent transparent transparent;
        }

        .info-badge.active .tooltip-popup {
            display: block;
            animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, 5px);
            }

            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Select all question marks with tooltips
            const infoBadges = document.querySelectorAll('.info-badge, .card-icon, .derivative-label, .meta-item, .rec-item, .level');

            infoBadges.forEach(badge => {
                // Get title content
                const title = badge.getAttribute('title');
                if (title) {
                    // Remove default browser tooltip
                    badge.removeAttribute('title');
                    badge.setAttribute('data-tooltip', title);

                    // Create custom popup element
                    const popup = document.createElement('div');
                    popup.className = 'tooltip-popup';
                    popup.textContent = title;

                    // Only append to info-badge for now
                    if (badge.classList.contains('info-badge')) {
                        badge.appendChild(popup);

                        // Click handler
                        badge.addEventListener('click', (e) => {
                            e.stopPropagation();
                            // Close all other tooltips
                            document.querySelectorAll('.info-badge.active').forEach(b => {
                                if (b !== badge) b.classList.remove('active');
                            });
                            // Toggle current
                            badge.classList.toggle('active');
                        });
                    } else {
                        // For non-badges, put it back to default behavior (or keep suppressed if desired)
                        badge.setAttribute('title', title);
                    }
                }
            });

            // Close tooltips when clicking outside
            document.addEventListener('click', () => {
                document.querySelectorAll('.info-badge.active').forEach(b => {
                    b.classList.remove('active');
                });
            });
        });
    </script>
</body>

</html>